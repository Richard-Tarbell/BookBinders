---
title: "Bookbinders Case Study"
author: "Austin Vanderlyn, Christine Kelly, Richard Tarbell"
date: "2/16/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(logistf)
library(tidyverse)
library(car)
library(broom)
library(DescTools)
library(ROCR)
library(e1071)
```

```{r, include=FALSE}
BBBC_Train <- read_excel("Data/BBBC-Train.xlsx",col_names = TRUE)
BBBC_Test <- read_excel("Data/BBBC-Test.xlsx",col_names = TRUE)
```


### I. Executive Summary - Richard
LM

Logit

SVM

### II. The Problem - Austin

### III. Review of Related Literature - Christine

### IV. Methodologies

### V. Data / Cleaning - Richard

### VI. Findings 

### VII. Conclusion and Recommendations

### Appendix


### Data importing and cleaning

```{r}
# Remove the observed column. Only run once
BBBC_Train <- BBBC_Train[2:12]
BBBC_Test <- BBBC_Test[2:12]

head(BBBC_Train)
```


```{r}
anyNA(BBBC_Train)
anyNA(BBBC_Test)
```

#### View training data

```{r}
str(BBBC_Train)
```

```{r}
# Convert to factors
BBBC_Train$Choice = as.factor(BBBC_Train$Choice)
BBBC_Train$Gender = as.factor(BBBC_Train$Gender)
```

#### View training data

```{r}
str(BBBC_Test)
```

```{r}
# Convert to factors
BBBC_Test$Choice = as.factor(BBBC_Test$Choice)
BBBC_Test$Gender = as.factor(BBBC_Test$Gender)
```



### Linear Regression Model


### Logistic Regression Model





### SVM Model

#### Use training split on BBBC_Train

```{r}
# Splitting data into training and testing sets 70/30 Split
set.seed(1)
tr_ind = sample(nrow(BBBC_Train), 0.7*nrow(BBBC_Train), replace=FALSE)
book.train.split = BBBC_Train[tr_ind,]
book.test.split = BBBC_Train[-tr_ind,]
```

```{r}
svm_form = Choice ~ .

tuned = tune.svm(svm_form, data = book.train.split, 
                 gamma = seq(.01, .1, by = .01), 
                 cost = seq(.1, 1, by = .1))
```


```{r}
mysvm = svm(formula = svm_form, 
            data = book.train.split, 
            gamma =tuned$best.parameters$gamma, 
            cost = tuned$best.parameters$cost)

summary(mysvm)
```

```{r}
# Predict on the test split
svmpredict = predict(mysvm, 
                     book.test.split, 
                     type = "response")

caret::confusionMatrix(svmpredict, book.test.split$Choice)
```

```{r}
svmpredict = predict(mysvm, 
                     BBBC_Test, 
                     type = "response")

caret::confusionMatrix(svmpredict, BBBC_Test$Choice)
```







